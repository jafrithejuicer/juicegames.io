<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juice Games</title>
<style>
  body { margin:0; font-family: Calibri, sans-serif; background:#f0f0f0; overflow:hidden; }
  #gameContainer { position: relative; width: 100vw; height: 100vh; background: #fff; }
  canvas { display:block; background:#fdfdfd; margin:0 auto; }

  /* Fullscreen / Minimize buttons */
  #controls { position:absolute; top:10px; right:10px; z-index:1000; }
  .btn { padding:8px 12px; margin-left:5px; background:#4CAF50; color:white; border:none; cursor:pointer; border-radius:4px; }

  /* Upcoming games panel */
  #upcoming { display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:#e0e0e0; z-index:900; padding:20px; overflow-y:auto; }
  #upcoming h2 { text-align:center; }
  .gameCard { background:white; padding:10px; margin:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.2); text-align:center; font-weight:bold; }

  /* Ad placeholders */
  #adLeft, #adRight { position:absolute; top:0; width:120px; height:100%; background:#ccc; z-index:800; text-align:center; line-height:2; font-weight:bold; }
  #adLeft { left:0; }
  #adRight { right:0; }
  #adBottom { position:absolute; bottom:0; left:0; width:100%; height:90px; background:#ccc; z-index:800; text-align:center; line-height:4; font-weight:bold; }

  /* Minimap */
  #minimap { position:absolute; bottom:100px; right:10px; width:200px; height:200px; background:rgba(0,0,0,0.3); border:2px solid red; z-index:900; }

  /* Leaderboard */
  #leaderboard { position:absolute; top:50px; right:10px; width:200px; background:rgba(0,0,0,0.3); color:white; padding:10px; border-radius:8px; z-index:900; }
</style>
</head>
<body>

<div id="gameContainer">
  <canvas id="game"></canvas>

  <div id="controls">
    <button class="btn" onclick="minimizeGame()">Minimize</button>
    <button class="btn" onclick="fullscreenGame()">Fullscreen</button>
  </div>

  <div id="adLeft">Ad Left</div>
  <div id="adRight">Ad Right</div>
  <div id="adBottom">Ad Bottom</div>

  <div id="upcoming">
    <h2>Upcoming Games</h2>
    <div class="gameCard">Slither.io</div>
    <div class="gameCard">Diep.io</div>
    <div class="gameCard">Paper.io</div>
    <div class="gameCard">Agar.io</div>
  </div>

  <div id="minimap"></div>
  <div id="leaderboard"></div>
</div>

<script>
const gameContainer = document.getElementById('gameContainer');
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const upcoming = document.getElementById('upcoming');

function minimizeGame() {
  canvas.style.display = 'none';
  document.getElementById('minimap').style.display = 'none';
  document.getElementById('leaderboard').style.display = 'none';
  upcoming.style.display = 'block';
}

function fullscreenGame() {
  canvas.style.display = 'block';
  document.getElementById('minimap').style.display = 'block';
  document.getElementById('leaderboard').style.display = 'block';
  upcoming.style.display = 'none';
}

// GAME LOGIC
let mouseX = 0, mouseY = 0;
let keys = {};
let player = null;
let bots = [];
let food = [];
let splitCells = [];
const MAP_SIZE = 25000;
const BOT_COUNT = 50;
const FOOD_COUNT = 10000;

// UTIL
function rand(min,max){ return Math.random()*(max-min)+min; }
function randInt(min,max){ return Math.floor(rand(min,max)); }
function randColor(){ return `hsl(${randInt(0,360)},80%,60%)`; }
function randName(){
  const names = ["Nebula","Orion","Venom","Nova","Titan","Echo","Rider","Vortex","Comet","Zero","Flash"];
  return names[randInt(0,names.length-1)];
}

// Player
function createPlayer(name){
  return {
    name,
    x: MAP_SIZE/2,
    y: MAP_SIZE/2,
    size: 40,
    color: '#00ccff',
    speed: 5,
    splitCells: []
  };
}

// Bot
function createBot(){
  return {
    name: randName(),
    x: rand(0,MAP_SIZE),
    y: rand(0,MAP_SIZE),
    size: rand(40,567),
    color: randColor(),
    speed: 2
  };
}

// Food
function createFood(){
  return {
    x: rand(0,MAP_SIZE),
    y: rand(0,MAP_SIZE),
    size: rand(3,8),
    color: randColor()
  };
}

// INIT
function init(){
  for(let i=0;i<BOT_COUNT;i++) bots.push(createBot());
  for(let i=0;i<FOOD_COUNT;i++) food.push(createFood());
}

function updatePlayerMovement(){
  if(!player) return;
  let targetX = player.x;
  let targetY = player.y;

  // Keyboard
  if(keys['w']) targetY -= player.speed;
  if(keys['s']) targetY += player.speed;
  if(keys['a']) targetX -= player.speed;
  if(keys['d']) targetX += player.speed;

  // Mouse movement
  if(!(keys['w']||keys['a']||keys['s']||keys['d'])){
    let dx = mouseX - canvas.width/2;
    let dy = mouseY - canvas.height/2;
    let dist = Math.hypot(dx,dy);
    if(dist>1){ dx/=dist; dy/=dist; targetX += dx*player.speed; targetY += dy*player.speed; }
  }

  // Slow down as player grows
  let speedFactor = Math.max(1, player.size/50);
  player.x += (targetX - player.x)/speedFactor;
  player.y += (targetY - player.y)/speedFactor;
}

// Split & Eject
function eject(){
  let angle = Math.atan2(mouseY-canvas.height/2, mouseX-canvas.width/2);
  let sizeLost = player.size*0.25;
  player.size -= sizeLost;
  splitCells.push({ x:player.x, y:player.y, size:sizeLost, vx:Math.cos(angle)*15, vy:Math.sin(angle)*15 });
}

function split(){
  if(player.size < 2) return;
  let newSize = player.size/2;
  let angle = Math.atan2(mouseY-canvas.height/2, mouseX-canvas.width/2);
  splitCells.push({ x:player.x, y:player.y, size:newSize, vx:Math.cos(angle)*25, vy:Math.sin(angle)*25 });
  player.size = newSize;
}

// Bots AI
function updateBots(){
  bots.forEach(b=>{
    let angle = rand(0,Math.PI*2);
    b.x += Math.cos(angle)*b.speed;
    b.y += Math.sin(angle)*b.speed;

    // Eat food
    for(let i=food.length-1;i>=0;i--){
      let f = food[i];
      if(Math.hypot(b.x-f.x, b.y-f.y) < b.size+f.size){
        b.size += f.size*0.1;
        food.splice(i,1);
      }
    }

    // Fight each other
    for(let j=bots.length-1;j>=0;j--){
      if(b===bots[j]) continue;
      let other = bots[j];
      let d = Math.hypot(b.x-other.x, b.y-other.y);
      if(d < b.size && b.size > other.size*1.05){
        b.size += other.size*0.4;
        bots[j] = createBot();
      }
    }
  });
}

// Update food for player
function updateFood(){
  for(let i=food.length-1;i>=0;i--){
    let f = food[i];
    if(Math.hypot(player.x-f.x, player.y-f.y) < player.size+f.size){
      player.size += f.size*0.05;
      food.splice(i,1);
    }
  }
}

// Draw
function draw(){
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,canvas.width,canvas.height);
  let zoom = 200/player.size;
  ctx.setTransform(zoom,0,0,zoom,canvas.width/2 - player.x*zoom, canvas.height/2 - player.y*zoom);

  // Food
  food.forEach(f=>{
    ctx.fillStyle = f.color;
    ctx.beginPath(); ctx.arc(f.x,f.y,f.size,0,Math.PI*2); ctx.fill();
  });

  // Bots
  bots.forEach(b=>{
    ctx.fillStyle = b.color;
    ctx.beginPath(); ctx.arc(b.x,b.y,b.size,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="white";
    ctx.font = `${Math.max(12,b.size/2)}px Calibri`;
    ctx.textAlign="center";
    ctx.fillText(b.name,b.x,b.y+5);
  });

  // Player
  ctx.fillStyle = player.color;
  ctx.beginPath(); ctx.arc(player.x,player.y,player.size,0,Math.PI*2); ctx.fill();
  ctx.fillStyle="white";
  ctx.font = `${Math.max(12,player.size/2)}px Calibri`;
  ctx.textAlign="center";
  ctx.fillText(player.name,player.x,player.y+5);

  // Split Cells
  splitCells.forEach(c=>{
    ctx.fillStyle = player.color;
    ctx.beginPath(); ctx.arc(c.x,c.y,c.size,0,Math.PI*2); ctx.fill();
  });
}

// Minimap
function drawMinimap(){
  const mm = document.getElementById('minimap');
  const mmCtx = mm.getContext('2d') || mm.getContext('2d');
  mm.width = 200;
  mm.height = 200;
  mmCtx.clearRect(0,0,mm.width,mm.height);
  const scale = mm.width/MAP_SIZE;
  mmCtx.fillStyle='blue';
  mmCtx.fillRect(player.x*scale-2, player.y*scale-2,4,4);
  bots.forEach(b=>{
    mmCtx.fillStyle='red';
    mmCtx.fillRect(b.x*scale-1, b.y*scale-1,2,2);
  });
}

// Leaderboard
function drawLeaderboard(){
  const lb = document.getElementById('leaderboard');
  let topBots = bots.slice().sort((a,b)=>b.size-a.size).slice(0,10);
  let html = `<strong>Leaderboard</strong><br>`;
  topBots.forEach((b,i)=>{
    html += `${i+1}. ${b.name} (${Math.floor(b.size)})<br>`;
  });
  html += `<br>Your Size: ${Math.floor(player.size)}`;
  lb.innerHTML = html;
}

// Loop
function loop(){
  updatePlayerMovement();
  updateFood();
  updateBots();

  splitCells.forEach(c=>{
    c.x += c.vx;
    c.y += c.vy;
  });

  draw();
  drawMinimap();
  drawLeaderboard();

  requestAnimationFrame(loop);
}

// Input
window.addEventListener('mousemove', e=>{ mouseX = e.clientX; mouseY = e.clientY; });
window.addEventListener('keydown', e=>{
  keys[e.key.toLowerCase()] = true;
  if(e.key.toLowerCase() === 'e') eject();
  if(e.key === ' ') split();
});
window.addEventListener('keyup', e=> keys[e.key.toLowerCase()] = false);

// Start
document.addEventListener('DOMContentLoaded', ()=>{
  let name = prompt("Enter your name") || "Player";
  player = createPlayer(name);
  init();
  loop();
});
</script>

</body>
</html>
